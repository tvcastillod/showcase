<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Coloring y modos de fusión # Introducción # Los modos de fusión se utilizan para controlar cómo se mezclan dos colores entre sí. En la edición de imágenes digitales, estos modos se utilizan para componer imágenes o generar efectos que permiten oscurecer, aclarar o resaltar ciertos colores de una imagen. Un color en glsl se define como una variable vec4 de valores rgba float normalizados, es decir, cada uno está en el rango de [0."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Coloring y modos de fusión # Introducción # Los modos de fusión se utilizan para controlar cómo se mezclan dos colores entre sí. En la edición de imágenes digitales, estos modos se utilizan para componer imágenes o generar efectos que permiten oscurecer, aclarar o resaltar ciertos colores de una imagen. Un color en glsl se define como una variable vec4 de valores rgba float normalizados, es decir, cada uno está en el rango de [0."><meta property="og:type" content="article"><meta property="og:url" content="https://jorodriguezal.github.io/showcase/docs/secciones/ilusiones-visuales/Coloring/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-05-25T21:16:01-05:00"><title>Coloring | Computación Visual</title><link rel=manifest href=/showcase/manifest.json><link rel=icon href=/showcase/favicon.png type=image/x-icon><link rel=stylesheet href=/showcase/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/showcase/flexsearch.min.js></script>
<script defer src=/showcase/en.search.min.3a8d658c77eb93c7f12a2b8af49a700131e474f288eefb605d9fa61576dbe5a7.js integrity="sha256-Oo1ljHfrk8fxKiuK9JpwATHkdPKI7vtgXZ+mFXbb5ac=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/showcase/><span>Computación Visual</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Secciones</span><ul><li><input type=checkbox id=section-b487fddfe213dc98103a22e30f20cced class=toggle>
<label for=section-b487fddfe213dc98103a22e30f20cced class="flex justify-between"><a href=/showcase/docs/secciones/integrantes/>Integrantes</a></label><ul><li><a href=/showcase/docs/secciones/integrantes/Johan-Steeb-Rodr%C3%ADguez-Alarc%C3%B3n/>Johan Steeb Rodríguez Alarcón</a></li><li><a href=/showcase/docs/secciones/integrantes/Tania-Valentina-Castillo-Delgado/>Tania Valentina Castillo Delgado</a></li><li><a href=/showcase/docs/secciones/integrantes/Mar%C3%ADa-Alejandra-Jim%C3%A9nez-Herrera/>María Alejandra Jiménez Herrera</a></li></ul></li><li><input type=checkbox id=section-812d2262a05fbae8105f136b96854c26 class=toggle checked>
<label for=section-812d2262a05fbae8105f136b96854c26 class="flex justify-between"><a href=/showcase/docs/secciones/ilusiones-visuales/>Ilusiones Visuales</a></label><ul><li><a href=/showcase/docs/secciones/ilusiones-visuales/v%C3%ADdeo-de-presentaci%C3%B3n/>Vídeo De Presentación</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/Coloring/ class=active>Coloring</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/Cuantificaci%C3%B3n-del-Color/>Cuantificación Del Color</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/fen%C3%B3meno-de-masking/>Fenómeno De Masking</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/Procesamiento-de-Imagen/>Procesamiento De Imagen</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/coloraci%C3%B3n/>Coloración</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/percepci%C3%B3n-de-profundidad/>Percepción De Profundidad</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/bandas-mach/>Bandas Mach</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/Coherencia-espacial/>Coherencia Espacial</a></li></ul></li><li><input type=checkbox id=section-659412a241b7c379147b1b576e09e56a class=toggle>
<label for=section-659412a241b7c379147b1b576e09e56a class="flex justify-between"><a role=button>Shaders Y 3 D</a></label><ul><li><a href=/showcase/docs/secciones/shaders-y-3D/posteffects/>Posteffects</a></li></ul></li><li><input type=checkbox id=section-6afa5302a62ba217d5088de37992068a class=toggle>
<label for=section-6afa5302a62ba217d5088de37992068a class="flex justify-between"><a href=/showcase/docs/secciones/p5/>P5</a></label><ul><li><a href=/showcase/docs/secciones/p5/iframe/>Iframe</a></li><li><a href=/showcase/docs/secciones/p5/div/>Div</a></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/showcase/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Coloring</strong>
<label for=toc-control><img src=/showcase/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#coloring-y-modos-de-fusión>Coloring y modos de fusión</a><ul><li><a href=#introducción>Introducción</a><ul><li><a href=#antecedentes-y-trabajo-previo>Antecedentes y trabajo previo</a></li></ul></li><li><a href=#ejercicio>Ejercicio</a><ul><li><a href=#solución>Solución</a></li><li><a href=#código>Código</a></li></ul></li><li><a href=#conclusión>Conclusión</a><ul><li><a href=#trabajo-futuro>Trabajo Futuro</a></li></ul></li><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=coloring-y-modos-de-fusión>Coloring y modos de fusión
<a class=anchor href=#coloring-y-modos-de-fusi%c3%b3n>#</a></h1><h2 id=introducción>Introducción
<a class=anchor href=#introducci%c3%b3n>#</a></h2><blockquote><div style=text-align:justify>Los modos de fusión se utilizan para controlar cómo se mezclan dos colores entre sí. En la edición de imágenes digitales, estos modos se utilizan para componer imágenes o generar efectos que permiten oscurecer, aclarar o resaltar ciertos colores de una imagen. Un color en glsl se define como una variable vec4 de valores rgba float normalizados, es decir, cada uno está en el rango de [0.0, 1.0]. Con la ayuda de shaders, podemos modificar esta variable con base en ciertos parámetros. A continuación se realizará la implementación de algunos de los modos de fusión de colores con el uso de shaders.</div></blockquote><h3 id=antecedentes-y-trabajo-previo>Antecedentes y trabajo previo
<a class=anchor href=#antecedentes-y-trabajo-previo>#</a></h3><blockquote><div style=text-align:justify>Los modos de fusión se originaron en la fotografía de cuarto oscuro y posteriormente se desarrollaron y mejoraron por programas de imagen digital como Adobe Photoshop. Los modos de fusión, que permiten combinar dos o más imágenes en una sola, fueron bien recibidos y se incorporaron rápidamente en otros programas de edición de imágenes [1]. Cuando se usan estos modos de fusión usualmente hay dos capas, una inferior que es la capa base, y una superior que es la capa de fusión. Cada uno de estos modos utiliza una operación matemática específica a los datos de color de cada píxel de la capa base y de fusión, lo cual resulta en una imagen compuesta. A continuación podemos ver algunos de los modos de fusión más conocidos</div><p align=center><img src=/showcase/img/blending_modes.png alt width=450px><br>Fig.1 - modos de fusión</p><h4 id=trabajo-previo>Trabajo previo
<a class=anchor href=#trabajo-previo>#</a></h4><div style=text-align:justify>Actualmente, cualquier herramienta de edición de imágenes ofrece la opción de aplicar modos de fusión, sin embargo, a continuación mencionamos un trabajo que se enfoca solo en este tema y es un proyecto de código libre disponible en github:<br><ul><li><a href=https://ilyashubin.github.io/FilterBlend/>Filter Blend</a> es una herramienta que permite componer dos imágenes por medio de diferentes modos de fusión, además permite aplicar filtros y controlar el parámetro de transparencia.</li></ul></div></blockquote><h2 id=ejercicio>Ejercicio
<a class=anchor href=#ejercicio>#</a></h2><blockquote class="book-hint info">Replicar el código js de los programas en <a href=https://visualcomputing.github.io/docs/shaders/coloring/>coloring</a>. Implementar otros modos de mezcla, tomando como referencia inicial la función <a href=https://p5js.org/es/reference/#/p5/blendMode>blendMode()</a> de p5js.</blockquote><h3 id=solución>Solución
<a class=anchor href=#soluci%c3%b3n>#</a></h3><blockquote><div style=text-align:justify><p>Recordemos que cada color es representado como un vector de 4 posiciones, donde las primeras 3 corresponden a los niveles de rojo, verde y azul de cada pixel, en el caso del modelo de color RGB, y la última representa el canal alfa que controla el nivel de transparencia. La idea general para implentar cualquier modo de fusión se basa en operar matemáticamente los valores de los pixeles de cada imagen, componente a componente. Uno de los modos más básicos es el <span style=color:#ff0>BLEND</span>, que consiste en multiplicar los valores del primer color <code>A</code> por un <code>factor</code> (entre 0-1) y sumarlo a los valores del segundo color <code>B</code>.</p><pre><code>C = A * factor + B
</code></pre><p>Este modo es una simple interpolación lineal de colores, donde el factor controla el nivel del color <code>A</code> que se aplica a B. Cuando el factor es igual a 0, el resultado es únicamente el color <code>B</code>. Cuando el factor es igual a 1, este funciona como el modo <span style=color:#ff0>ADDITION</span> que suma los valores <code>A</code> y <code>B</code>.</p><pre><code>C = A + B
</code></pre><p>Es importante recordar que el valor de los pixeles está condicionado a un rango de 0.0 a 1.0 por lo que si los valores establecidos están fuera de este rango, estos automáticamente se ajustan al valor más cercano, 0.0 si es un valor negativo o 1.0 si es positivo mayor que 1. Por esta razón, cuando la suma de ambos valores es mayor a 1, el resultado es un color blanco representado como (1.0, 1.0, 1.0). Este modo también es conocido como <em>plus lighter</em> pues el resultado siempre produce un color más claro, ya que toma valores más altos. Una variante de este modo es el <span style=color:#ff0>PLUS DARKER</span> que consiste en restar 1.0 al valor final, dando como resultado un valor más oscuro que si es menor a 0 muestra un color negro.</p><pre><code>C = A + B - 1.0</code></pre><p>Análogo al modo <em>addition</em> se define el modo <span style=color:#ff0>SUBSTRACT</span> como la resta de <code>A</code> y <code>B</code>.</p><pre><code>C = A - B</code></pre><p>Aquí, de forma opuesta al modo anterior, lo que sucede es que se dan valores negativos y por tanto, cuando la resta es menor a 0, el resultado da un color negro. Se tienen además los modos <span style=color:#ff0>DARKEST</span> y su contraparte <span style=color:#ff0>LIGHTEST</span> donde se toma el color más oscuro y más claro respectivamente.</p><pre><code>C = min(A * factor, B) // darkest
C = max(A * factor, B) // lightest
</code></pre><p>En este caso, el color <code>A</code> es multiplicado por un factor para luego ser comparado con el color <code>B</code>. Esta comparación es por componente, es decir, se tomar el valor mínimo/máximo para cada canal RGB, lo cual hace que el resultado sea más o menos oscuro/claro. También está el modo <span style=color:#ff0>MULTIPLY</span> que consiste en multiplicar los dos valores</p><pre><code>C = A * B</code></pre><p>Si uno de los colores está dentro de la escala de grises, este modo genera un efecto de oscurecimiento sobre el otro color, donde un color cercano al negro hace que el otro color se vuelva más oscuro. Con el modo <span style=color:#ff0>SCREEN</span> los valores de los pixeles de los dos colores se invierten, se multiplican y se vuelven a invertir, dando un resultado opuesto al del modo <em>multiplicar</em>, dando un efecto de aclarado.</p><pre><code>C = 1 - (1 - A)(1 - B)</code></pre><p>Algo que también se puede hacer es combinar dos modos distintos, como por ejemplo el <em>multiply</em> y el <em>screen</em>. Dependiendo de la condición, la combinación de estos dos modos toma un nombre diferente, en este caso usaremos el llamado modo <span style=color:#ff0>OVERLAY</span> que se define de la siguiente manera:</p><pre><code>Si a < 0.5 entonces C = 2AB
sino C = 1 - 2(1 - A)(1 - B)</code></pre><p>Aquí, se usa el modo <em>multiply</em> para valores más oscuros y <em>screen</em> para valores más claros, de modo que las zonas más oscuras en una imagen se vuelven más oscuras y las zonas más claras se vuelven más claras. La constante 2 cumple la función de compensar la mezcla de colores, haciendo que haya una transición más homogénea cuando se está cerca de la igualdad de la condición.</p></div><blockquote><p style=text-align:justify>A continuación, tenemos la implementación de los modos de fusión en colores. Se muestran dos modos al tiempo con el fin de observar las diferencias entre los resultados de cada modo.</p><iframe id=blend_color_modes style=width:625px;height:425px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js></script>
            <script src=https://cdn.jsdelivr.net/gh/VisualComputing/p5.treegl/p5.treegl.min.js></script>
            
            
            
            
            
            <script src=/showcase/sketches/coloring/blend_color_modes.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe></blockquote><div style=text-align:justify>Como ya sabemos a grandes rasgos cómo funcionan distintos modos de fusión, ahora podemos implementarlos en imágenes. La idea es exactamente la misma, solo que ahora tenemos una paleta de colores más amplia dada por 2 imágenes diferentes. En este caso, los modos de fusión permiten hacer composiciones interesantes y dependiento de la capa de fusión que se use se pueden crear algunos efectos interesantes sobre la imagenes base. Veamos algunos ejemplos de modos de fusión aplicados a las siguientes imágenes:</br><p align=center><img src=/showcase/img/modeimage.png alt width=600px><br>Fig.2 - imágenes de la capa base (izquierda) y la capa de fusión (derecha)</p></br>Primero, veamos el modo DARKEST. Sabemos que este modo toma el menor valor de cada color, haciendo que el resultado sea un color más oscuro. Además, la capa base es multiplicada por un factor que al disminuir hace que el color original se oscuresca, como podemos ver a continuación:</br><p align=center><img src=/showcase/img/ejemplomod1.png alt width=600px><br>Fig.3 - modo DARKEST con factores de 0.19, 0.58 y 1.0 aplicados a una imagen</p></br><p>Así, podemos oscurecer imágenes con este modo, cambiando el factor. Ahora, veamos los modos MULTIPLY, SCREEN y OVERLAY. Pero antes recordemos que <em>multiply</em> también genera un efecto de oscurecimiento, esto se debe a que al multiplicar cualquier número por un número menor que uno, el producto es menor que el número multiplicado, y como los valores de los colores son menores o iguales a 1, el resultado son valores más pequeños, que corresponden a colores más oscuros. De la misma forma, el modo <em>screen</em> tiene el efecto contrario ya que se invierten los colores, dando valores más altos, que corresponden a colores más claros.</br></p><p align=center><img src=/showcase/img/ejemplomod3.png alt width=600px><br>Fig.4 - modos multiply, screen y overlay aplicados a imágenes</p></br><p>En este caso, es interesante ver el resultado del modo <em>overlay</em> aplicado una imagen, pues al ser una combinación de los dos modos anteriores, se genera una imagen más vistosa, ya que los colores más claros resaltan más mientras que los oscuros se ven más marcados, logrando un contraste en la imagen que hace que ciertos detalles destaquen más.</br>Para el último ejemplo, tomamos dos imágenes diferentes como capas de fusión para la misma imagen base, con los modos LIGHTEST y ADDITON logramos el siguiente resultado:</br></p><p align=center><img src=/showcase/img/exampleflower.png alt width=650px><br>Fig.5 - modos lightest y addition con dos capas de fusión diferentes</p></br><p>Vemos como logramos dos efectos interesantes, uno donde se combinan ambas imágenes con ayuda de lightest y otro donde logramos darle una forma a la imagen, usando una capa con una figura de un color sólido.</p><blockquote class="book-hint info">Hay que tener en cuenta que si invertimos las capas, se pueden obtener resultados diferentes para algunos modos como el de <em>substract</em> y <em>overlay</em>.</blockquote></div><blockquote><p style=text-align:justify>A continuación, tenemos la implementación de los modos de fusión en imágenes. Por defecto, la imagen a la izquierda es la capa base y la imagen a la derecha es la capa de fusión que es aplicada a la base. Se pueden escoger entre 9 modos de fusión diferentes.</p><iframe id=blend_color_images style=width:625px;height:425px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js></script>
            <script src=https://cdn.jsdelivr.net/gh/VisualComputing/p5.treegl/p5.treegl.min.js></script>
            
            
            
            
            
            <script src=/showcase/sketches/coloring/blend_color_images.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe></blockquote><blockquote class="book-hint info"><p style=text-align:justify></blockquote><div style=text-align:justify></div></blockquote><h3 id=código>Código
<a class=anchor href=#c%c3%b3digo>#</a></h3><blockquote><details><summary>Código completo de la implementación de los modos de fusión</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colorPicker1</span>, <span style=color:#a6e22e>colorPicker2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sliderMode1</span>, <span style=color:#a6e22e>sliderMode2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>selectMode1</span>, <span style=color:#a6e22e>selectMode2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>shaderMode1</span>, <span style=color:#a6e22e>shaderMode2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>brightness1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>brightness2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadShader</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader.vert&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader.frag&#34;</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadShader</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader.vert&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader.frag&#34;</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorPicker1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#e6db74>&#34;#F09A9A&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorPicker1</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>140</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>60</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorPicker2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#e6db74>&#34;#E2D98D&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorPicker2</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>80</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>60</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>15</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>70</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;BLEND&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;DARKEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;LIGHTEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;ADDITION&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;PLUS DARKER&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;SUBSTRACT&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;MULTIPLY&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;SCREEN&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;OVERLAY&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#34;LIGHTEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>changed</span>(<span style=color:#a6e22e>mySelectEvent</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>15</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;BLEND&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;DARKEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;LIGHTEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;ADDITION&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;PLUS DARKER&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;SUBSTRACT&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;MULTIPLY&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;SCREEN&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;OVERLAY&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#34;DARKEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>changed</span>(<span style=color:#a6e22e>mySelectEvent</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>110</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>70</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;80px&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode2</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>110</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode2</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;80px&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>120</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode1</span>.<span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>shaderMode1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>120</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode2</span>.<span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>shaderMode2</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>220</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>c1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>colorPicker1</span>.<span style=color:#a6e22e>color</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>c2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>colorPicker2</span>.<span style=color:#a6e22e>color</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMaterial1&#34;</span>, <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_array</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMaterial2&#34;</span>, <span style=color:#a6e22e>c2</span>.<span style=color:#a6e22e>_array</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;blendMode&#34;</span>, <span style=color:#a6e22e>mode1</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mode1</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>brightness_1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>brightness_1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;brightness&#34;</span>, <span style=color:#a6e22e>brightness_1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode1</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode2</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMaterial1&#34;</span>, <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_array</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode2</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMaterial2&#34;</span>, <span style=color:#a6e22e>c2</span>.<span style=color:#a6e22e>_array</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode2</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;blendMode&#34;</span>, <span style=color:#a6e22e>mode2</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mode2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>brightness2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sliderMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sliderMode2</span>.<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>brightness2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sliderMode2</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode2</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;brightness&#34;</span>, <span style=color:#a6e22e>brightness2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode2</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imageMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rectMode</span>(<span style=color:#a6e22e>CENTER</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>colorMode1</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>65</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colorPicker1</span>.<span style=color:#a6e22e>color</span>());
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>110</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>250</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noFill</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>120</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colorPicker2</span>.<span style=color:#a6e22e>color</span>());
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>110</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>250</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode2</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>colorMode2</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>65</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noFill</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>120</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mySelectEvent</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;BLEND&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;DARKEST&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;LIGHTEST&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;ADDITION&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;PLUS DARKER&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;SUBSTRACT&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;MULTIPLY&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>7</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;SCREEN&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;OVERLAY&#34;</span>) <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>9</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;BLEND&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;DARKEST&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;LIGHTEST&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;ADDITION&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;PLUS DARKER&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;SUBSTRACT&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;MULTIPLY&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>7</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;SCREEN&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode2</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;OVERLAY&#34;</span>) <span style=color:#a6e22e>mode2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>9</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><details><summary>vertex shader (genérico)</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>attribute</span> <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>aPosition</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>positionVec4</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>aPosition</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>positionVec4</span>.<span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>positionVec4</span>.<span style=color:#a6e22e>xy</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_Position</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>positionVec4</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><details><summary>fragment shader</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>brightness</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>uMaterial1</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>blendMode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>material</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// BLEND
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// DARKEST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>, <span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// LIGHTEST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>, <span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ADDITION
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// PLUS DARKER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// SUBSTRACT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// MULTIPLY
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>8</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// SCREEN
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span>(<span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>)<span style=color:#f92672>*</span>(<span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>9</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// OVERLAY
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>r</span>);}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>g</span>);}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>b</span>);}
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><div style=text-align:justify><p>A continuación se muestra de forma más detallada las partes claves del código anterior.</p><p><details open><summary>parámetros que se envían a los shaders</summary><div class=markdown-inner><p>Con ayuda de <code>setUniform</code>, la información de los parámetros principales es enviada a los shaders para poder obtener el color resultante de la mezcla de los otros dos. Los parámetros que se necesitan son:</p><ul><li><code>uMaterial1</code>, <code>uMaterial2</code>, que corresponden a dos vectores <code>vec4</code> con la información de los dos colores a mezclar en formato RGB, con valores entre 0.0 y 1.0.</li><li><code>blendMode</code> que corresponde a un <code>float</code> que indica el modo de fusión y el cual determina la operación a realizar con los dos vectores de color.</li><li><code>brightness</code> que corresponde al factor por el cual es multiplicado el color base en los modos BLEND, LIGHTEST Y DARKEST.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>c1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>colorPicker1</span>.<span style=color:#a6e22e>color</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>c2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>colorPicker2</span>.<span style=color:#a6e22e>color</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMaterial1&#34;</span>, <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_array</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMaterial2&#34;</span>, <span style=color:#a6e22e>c2</span>.<span style=color:#a6e22e>_array</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;blendMode&#34;</span>, <span style=color:#a6e22e>mode1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mode1</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode1</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>brightness_1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>brightness_1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode1</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;brightness&#34;</span>, <span style=color:#a6e22e>brightness_1</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>colorMode1</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span></code></pre></div></div></details></br><details open><summary>código de los shaders</summary><div class=markdown-inner><p>Para el vertex shader usamos el código base del tutorial en p5js. En el fragment shader, la variable que debemos modificar es la de <code>gl_FragColor</code> que se encarga de definir el color final de cada pixel. Para esto, simplemente establecemos una serie de condiciones para que dependiendo el modo <code>blendMode</code>, se realice la operación correspondiente con los valores del color <code>uMaterial1</code>, <code>uMaterial2</code> y el factor <code>brightness</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>material</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// BLEND
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// DARKEST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>, <span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>){
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementación de los modos LIGHTEST, ADDITION, PLUS DARKER, SUBSTRACT, MULTIPLY, SCREEN
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ...
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>9</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// OVERLAY
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>r</span>);}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>g</span>);}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>b</span>);}
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Algo relevante es que debido a que se da la opción de usar dos modos diferentes al tiempo, se crean variables diferentes para mostrar ambos colores, pero con la misma plantilla del código shader. Para esto cargamos el shader con <code>loadShader()</code>, en el setup() lo asignamos a un buffer gráfico con <code>createGraphics(_, _, WEBGL)</code> y en draw() aplicamos el shader a <code>rect()</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadShader</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader.vert&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader.frag&#34;</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode2</span> <span style=color:#f92672>=</span> ...
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>120</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode1</span>.<span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>shaderMode1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode2</span> <span style=color:#f92672>=</span> ...
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shaderMode1</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;brightness&#34;</span>, <span style=color:#a6e22e>brightness_1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode1</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode2</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></p></div></br><details><summary>Código completo de la implementación de los modos de fusión en imágenes</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>brightness_</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>layer</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>s1</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>sketch</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>, <span style=color:#a6e22e>myShader</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>preload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/showcase/sketches/coloring/lenna.png&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>loadShader</span>(
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader_img.vert&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;/showcase/sketches/coloring/shader_img.frag&#34;</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>setup</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>canvas1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>300</span>, <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>canvas1</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>canvas1</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>draw</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>myShader</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>mode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>brightness_</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sliderMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>brightness_</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;blendMode&#34;</span>, <span style=color:#a6e22e>mode</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;brightness&#34;</span>, <span style=color:#a6e22e>brightness_</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;base&#34;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;layer&#34;</span>, <span style=color:#a6e22e>layer</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;image&#34;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>loadImage</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;El archivo seleccionado no es una imagen.&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// create a new instance of p5 and pass in the function for sketch 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>p5</span>(<span style=color:#a6e22e>s1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>s2</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>sketch</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>preload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>layer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/showcase/sketches/coloring/black-gradient.jpg&#34;</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>setup</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>canvas1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>300</span>, <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>canvas1</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>310</span>, <span style=color:#a6e22e>canvas1</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>draw</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>layer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>imgResize</span>(<span style=color:#a6e22e>layer</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>layer</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>150</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>p5</span>(<span style=color:#a6e22e>s2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;image&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>layer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;El archivo seleccionado no es una imagen.&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>imgResize</span>(<span style=color:#a6e22e>img</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>imgW</span>, <span style=color:#a6e22e>imgH</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>/*si el tamaño de la imagen es muy grande,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        se hace un reajuste*/</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgW</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>300</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgH</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgW</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgH</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>300</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>resize</span>(<span style=color:#a6e22e>imgW</span>, <span style=color:#a6e22e>imgH</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>220</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>350</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;BLEND&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;DARKEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;LIGHTEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;ADDITION&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;PLUS DARKER&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;SUBSTRACT&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;MULTIPLY&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;SCREEN&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;OVERLAY&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#34;LIGHTEST&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>changed</span>(<span style=color:#a6e22e>mySelectEvent</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>350</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sliderMode</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;80px&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mySelectEvent</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;BLEND&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;DARKEST&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;LIGHTEST&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;ADDITION&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;PLUS DARKER&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;SUBSTRACT&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;MULTIPLY&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>7</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;SCREEN&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectMode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;OVERLAY&#34;</span>) <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>9</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><details><summary>vertex shader</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>attribute</span> <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>aPosition</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>attribute</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>aTexCoord</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>vTexCoord</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vTexCoord</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>aTexCoord</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>positionVec4</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>aPosition</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>positionVec4</span>.<span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>positionVec4</span>.<span style=color:#a6e22e>xy</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_Position</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>positionVec4</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><details><summary>fragment shader</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>brightness</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>blendMode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>vTexCoord</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>base</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>layer</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vTexCoord</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>color2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>base</span>, <span style=color:#a6e22e>uv</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>color2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>layer</span>, <span style=color:#a6e22e>uv</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>uMaterial2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color2</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>material</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// BLEND
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// DARKEST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>, <span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// LIGHTEST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>brightness</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>, <span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ADDITION
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// PLUS DARKER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>uMaterial2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// SUBSTRACT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// MULTIPLY
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial2</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>8</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// SCREEN
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span>(<span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>)<span style=color:#f92672>*</span>(<span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>9</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>r</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>r</span>);}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>g</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>g</span>);}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial1</span>.<span style=color:#a6e22e>b</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uMaterial2</span>.<span style=color:#a6e22e>b</span>);}
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><div style=text-align:justify><p>A continuación se muestra de forma más detallada las partes claves del código anterior.
<details open><summary>crear dos canvas diferentes</summary><div class=markdown-inner><p>Para cargar y modificar las imágenes por separado, se optó por crear dos canvas diferentes para cada imagen. De esta forma, podemos aplicar la capa de fusión sobre la capa base, de forma que el shader solo afecte a una de las imágenes. Para esto, la idea es crear una función sketch <code>s1</code> con la misma lógica aplicada a los colores, crear una nueva instancia de p5 con <code>new p5(s1)</code> y pasar esta función. El código base para lograr esto fué tomado del siguiente <a href=https://editor.p5js.org/caminofarol/sketches/r609C2cs>sketch</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>s1</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>sketch</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>, <span style=color:#a6e22e>myShader</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>preload</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se carga el shader
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>setup</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se crea el canvas 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sketch</span>.<span style=color:#a6e22e>draw</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se aplica el shader
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// función para cargar los archivos de imagen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// codigo base para crear dos canvas diferentes: https://editor.p5js.org/caminofarol/sketches/r609C2cs
</span></span></span><span style=display:flex><span><span style=color:#75715e>// se crea una nueva instancia de p5 pasando la función para el sketch 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>p5</span>(<span style=color:#a6e22e>s1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>s2</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>sketch</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// código para cargar la segunda imagen.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>p5</span>(<span style=color:#a6e22e>s2</span>);
</span></span></code></pre></div><p>De la misma forma se crea otra función para el segundo canvas con la imagen de la capa de fusión. En este caso lo único que se necesita es cargar la imagen y almacenarla en una variable para enviarla al shader que modifica la imagen base dentro del sketch 1.</p></div></details></br><details open><summary>código de shaders</summary><div class=markdown-inner><p>Para el vertex shader el único cambio relevante es que debemos pasar información sobre las coordenadas de textura <code>aTexCoord</code>, que nos permite definir cómo se mapea una imagen en una superficie, en este caso la imagen base. Y pasamos este dato al fragment shader como <code>vTexCoord</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>attribute</span> <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>aPosition</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>attribute</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>aTexCoord</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>vTexCoord</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vTexCoord</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>aTexCoord</span>;
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Para el fragment shader tenemos los mismos parámetros que en la implementación de colores. La única diferencia
es que en vez de un vec4 de color, usamos <code>sampler2D</code> que es el tipo de variable que se usa para texturas. Luego,
usamos <code>texture2D(base, uv)</code>, que recibe la textura y las coordenadas uv de textura, para obtener el color de cada imagen. Finalmente, realizamos el mismo procedimiento que con los colores para calcular el resultado final dependiendo el modo de fusión.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>brightness</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>blendMode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>vTexCoord</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>base</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>layer</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vTexCoord</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>color2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>base</span>, <span style=color:#a6e22e>uv</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>color2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>layer</span>, <span style=color:#a6e22e>uv</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>uMaterial1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>uMaterial2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color2</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>material</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blendMode</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// operaciones para cada modo de fusión
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ...
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>material</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>material</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Se tomó como referencia el siguiente <a href=https://youtu.be/q6nywvlhEFM>video</a> para entender e implementar correctamente el concepto de textura en los shaders de este ejercicio.</p></div></details></p></div></blockquote><h2 id=conclusión>Conclusión
<a class=anchor href=#conclusi%c3%b3n>#</a></h2><blockquote><div style=text-align:justify>Los modos de fusión permiten realizar composiciones interesantes con imágenes. Dependiendo el modo que se utilice se pueden lograr efectos para oscurecer, aclarar y resaltar ciertos colores en imágenes. Además, este tema nos permite entender cómo se representan los colores y cómo se pueden modificar, manipulando los valores que lo componen. Asimismo, el uso de shaders es de gran importancia para facilitar la manipulación de colores, principalmente en el uso de imágenes.</div><h3 id=trabajo-futuro>Trabajo Futuro
<a class=anchor href=#trabajo-futuro>#</a></h3><div style=text-align:justify>Debido a que solo se implementaron algunos modos de fusión, como trabajo futuro sería bueno ampliar la variedad de modos que se pueden usar. Además, se podría dar la opción de mezclar más de 2 colores/imágenes, con la posibilidad de modificar el parámetro de transparencia. También sería interesante dar la posibilidad al usuario de escoger entre una lista de capas predeterminadas, con formas y colores que permitan crear una composición diferente.</br><p align=center><img src=/showcase/img/blend-modes-add.png alt width=400px><br>Fig.6 - Más modos de fusión con imágenes</p></div></blockquote><h2 id=referencias>Referencias
<a class=anchor href=#referencias>#</a></h2><ol><li>C. Ace. Blending Modes Explained. Tomado de <a href=https://www.videomaker.com/article/c03/18076-blending-modes-explained/>https://www.videomaker.com/article/c03/18076-blending-modes-explained/</a></li><li>Wikipedia contributors. &ldquo;Blend modes&rdquo;. Tomado de <a href=https://en.wikipedia.org/wiki/Blend_modes>https://en.wikipedia.org/wiki/Blend_modes</a></li><li>Photoshop Tools & Techniques. &ldquo;Blending Modes Explained – The Complete Guide to Photoshop Blend Modes&rdquo;. Tomado de <a href=https://photoshoptrainingchannel.com/blending-modes-explained/#overlay>https://photoshoptrainingchannel.com/blending-modes-explained/#overlay</a></li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/visualcomputing/showcase/commit/8375dc73998d86d9c989afc511ffef9b75e8fc7b title='Last modified by Tania Castillo | May 26, 2023' target=_blank rel=noopener><img src=/showcase/svg/calendar.svg class=book-icon alt=Calendar>
<span>May 26, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#coloring-y-modos-de-fusión>Coloring y modos de fusión</a><ul><li><a href=#introducción>Introducción</a><ul><li><a href=#antecedentes-y-trabajo-previo>Antecedentes y trabajo previo</a></li></ul></li><li><a href=#ejercicio>Ejercicio</a><ul><li><a href=#solución>Solución</a></li><li><a href=#código>Código</a></li></ul></li><li><a href=#conclusión>Conclusión</a><ul><li><a href=#trabajo-futuro>Trabajo Futuro</a></li></ul></li><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></div></aside></main></body></html>