<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Cuantificación del Color y Dithering # Introducción # La cuantificación del color consiste en reducir el número de colores utilizados en una imagen dada un condición. Esto es importante para la visualización de imágenes en dispositivos que soportan un número limitado de colores y para obtener una mayor eficiencia en la compresión de ciertos tipos de imágenes. A continuación se implementarán algunos tipos de dithering como acercamiento al concepto de cuantización de color."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Cuantificación del Color y Dithering # Introducción # La cuantificación del color consiste en reducir el número de colores utilizados en una imagen dada un condición. Esto es importante para la visualización de imágenes en dispositivos que soportan un número limitado de colores y para obtener una mayor eficiencia en la compresión de ciertos tipos de imágenes. A continuación se implementarán algunos tipos de dithering como acercamiento al concepto de cuantización de color."><meta property="og:type" content="article"><meta property="og:url" content="https://jorodriguezal.github.io/showcase/docs/secciones/ilusiones-visuales/Cuantificaci%C3%B3n-del-Color/"><meta property="article:section" content="docs"><title>Cuantificación Del Color | Computación Visual</title><link rel=manifest href=/showcase/manifest.json><link rel=icon href=/showcase/favicon.png type=image/x-icon><link rel=stylesheet href=/showcase/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/showcase/flexsearch.min.js></script>
<script defer src=/showcase/en.search.min.3a8d658c77eb93c7f12a2b8af49a700131e474f288eefb605d9fa61576dbe5a7.js integrity="sha256-Oo1ljHfrk8fxKiuK9JpwATHkdPKI7vtgXZ+mFXbb5ac=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/showcase/><span>Computación Visual</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Secciones</span><ul><li><input type=checkbox id=section-b487fddfe213dc98103a22e30f20cced class=toggle>
<label for=section-b487fddfe213dc98103a22e30f20cced class="flex justify-between"><a href=/showcase/docs/secciones/integrantes/>Integrantes</a></label><ul><li><a href=/showcase/docs/secciones/integrantes/Johan-Steeb-Rodr%C3%ADguez-Alarc%C3%B3n/>Johan Steeb Rodríguez Alarcón</a></li><li><a href=/showcase/docs/secciones/integrantes/Tania-Valentina-Castillo-Delgado/>Tania Valentina Castillo Delgado</a></li><li><a href=/showcase/docs/secciones/integrantes/Mar%C3%ADa-Alejandra-Jim%C3%A9nez-Herrera/>María Alejandra Jiménez Herrera</a></li></ul></li><li><input type=checkbox id=section-812d2262a05fbae8105f136b96854c26 class=toggle checked>
<label for=section-812d2262a05fbae8105f136b96854c26 class="flex justify-between"><a href=/showcase/docs/secciones/ilusiones-visuales/>Ilusiones Visuales</a></label><ul><li><a href=/showcase/docs/secciones/ilusiones-visuales/v%C3%ADdeo-de-presentaci%C3%B3n/>Vídeo De Presentación</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/Cuantificaci%C3%B3n-del-Color/ class=active>Cuantificación Del Color</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/fen%C3%B3meno-de-masking/>Fenómeno De Masking</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/coloraci%C3%B3n/>Coloración</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/percepci%C3%B3n-de-profundidad/>Percepción De Profundidad</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/bandas-mach/>Bandas Mach</a></li><li><a href=/showcase/docs/secciones/ilusiones-visuales/Coherencia-espacial/>Coherencia Espacial</a></li></ul></li><li><input type=checkbox id=section-6afa5302a62ba217d5088de37992068a class=toggle>
<label for=section-6afa5302a62ba217d5088de37992068a class="flex justify-between"><a href=/showcase/docs/secciones/p5/>P5</a></label><ul><li><a href=/showcase/docs/secciones/p5/iframe/>Iframe</a></li><li><a href=/showcase/docs/secciones/p5/div/>Div</a></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/showcase/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Cuantificación Del Color</strong>
<label for=toc-control><img src=/showcase/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#cuantificación-del-color-y-dithering>Cuantificación del Color y Dithering</a><ul><li><a href=#introducción>Introducción</a><ul><li><a href=#antecedentes-y-trabajo-previo>Antecedentes y trabajo previo</a></li></ul></li><li><a href=#ejercicio>Ejercicio</a><ul><li><a href=#solución>Solución</a></li><li><a href=#código>Código</a></li></ul></li><li><a href=#conclusión>Conclusión</a><ul><li><a href=#trabajo-futuro>Trabajo Futuro</a></li></ul></li><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=cuantificación-del-color-y-dithering>Cuantificación del Color y Dithering
<a class=anchor href=#cuantificaci%c3%b3n-del-color-y-dithering>#</a></h1><h2 id=introducción>Introducción
<a class=anchor href=#introducci%c3%b3n>#</a></h2><blockquote><p style=text-align:justify>La cuantificación del color consiste en reducir el número de colores utilizados en una imagen dada un condición. Esto es importante para la visualización de imágenes en dispositivos que soportan un número limitado de colores y para obtener una mayor eficiencia en la compresión de ciertos tipos de imágenes. A continuación se implementarán algunos tipos de dithering como acercamiento al concepto de cuantización de color.</p></blockquote><h3 id=antecedentes-y-trabajo-previo>Antecedentes y trabajo previo
<a class=anchor href=#antecedentes-y-trabajo-previo>#</a></h3><blockquote><p style=text-align:justify>El dithering es una forma de ruido aplicada a una imagen para aleatorizar el error en la cuantificación de color, con el fin de evitar patrones a gran escala, como lo son las bandas de color en imágenes. Asimismo se usa para crear una ilusión de profundidad de color en imágenes con una paleta de colores limitada. Este proceso también suele ser utilizado en el procesamiento de datos de audio y vídeo.</p><h4 id=thresholding-o-dithering-promedio>Thresholding o dithering promedio
<a class=anchor href=#thresholding-o-dithering-promedio>#</a></h4><p style=text-align:justify>Este método consiste en comparar cada valor de píxel con un umbral fijo y dependiendo de esto se le asigna un valor de pixel de 0 o 255, dando como resultado una imagen binaria, compuesta únicamente de pixeles blancos y negros. Aunque es uno de los algoritmos más sencillos, este suele provocar una pérdida de detalle y contorno significativa.</p><h4 id=dithering-aleatorio>Dithering aleatorio
<a class=anchor href=#dithering-aleatorio>#</a></h4><p style=text-align:justify>Este método es análogo al thresholding básico, la única diferencia es que en vez de tener un valor de umbral fijo, se tiene un valor aleatorio entre 1 y 256 para cada pixel. En este caso no tenemos el problema de hallar el valor indicado de umbral sin embargo el "ruido blanco" que se genera por la aleatoriedad hace que el detalle de la imagen se pierda.</p><h4 id=trabajo-previo>Trabajo previo
<a class=anchor href=#trabajo-previo>#</a></h4><p>A continuación se listan algunos trabajos previos realizados sobre este tema:</p><ul><li><a href=https://www.visgraf.impa.br/Courses/ip00/proj/Dithering1/>Image Based Artistic Dithering</a> es un software que implementa los algoritmos más clásicos de dithering como dithering promedio, dithering de Floyd-Steinberg, dithering ordenado y dithering aleatorio.</li><li><a href=https://ditherit.com/>Dither it!</a> es una herramienta que nos da dos opciones de dithering, el método de Bayer y el método de difusión de error, además permite modificar la paleta de colores de la imagen final.</li></ul></blockquote><h2 id=ejercicio>Ejercicio
<a class=anchor href=#ejercicio>#</a></h2><blockquote class="book-hint info">Investigar e implementar algunas aplicaciones visuales de dither.</blockquote><h3 id=solución>Solución
<a class=anchor href=#soluci%c3%b3n>#</a></h3><blockquote><p style=text-align:justify>Primero, analicemos el algoritmo de thresholding. La efectividad de este método se puede evidenciar mejor en imágenes donde la diferencia entre los pixeles de los objetos y del fondo es alta, es decir, imágenes donde los objetos se distinguen fácilmente del fondo. Veamos cómo con la ayuda de un histograma de pixeles podemos aproximar el valor óptimo de umbral para procesar una imagen. Se tiene el siguiente ejemplo:</p><br><p align=center><img src=/showcase/img/example_img_hist.png alt width=450px><br>Fig.1 - imagen ejemplo con su respectivo histograma de pixeles</p><br><p style=text-align:justify>Haciendo un análisis general del histograma, podemos notar que hay un pico en pixeles con un valor alrededor de 80, y podemos deducir que estos corresponde al fondo de la imagen, ya que es el color que predomina en la imagen. Con esta simple observación, podemos conjeturar que el valor óptimo de umbral está alrededor 100, pues es allí donde se marca una diferencia de valores en los pixeles. Veamos cómo se ve la imagen con diferentes valores de umbral, en particular en el rango de 100 a 150.<br><p align=center><img src=/showcase/img/example_img_u.png alt width=500px><br>Fig.2 - imagen ejemplo con su respectivo histograma de pixeles</p><br><p style=text-align:justify>Podemos evidenciar que el valor de umbral supuesto es adecuado. Ahora, si intentáramos realizar un análisis similar para una imagen que no cumple con las mismas condiciones sugeridas al inicio, el umbral ya no es tan evidente y de hecho, la imagen resultante en general no es tan clara(véase la figura 3).</p><p align=center><img src=/showcase/img/example2_img_hist_u.png alt width=500px><br>Fig.3 - histograma de pixeles e imágenes con umbral igual a 100 125 y 150</p><br><p style=text-align:justify>Esto ocurre ya que los pixeles de la imagen son más homogéneos, lo cual hace que no se puedan diferencia tan fácilmente los objetos en la imagen, lo cual se puede evidenciar en el histograma, el cual no muestra un patrón que nos ayude a diferenciar las zonas de la imagen como en el anterior ejemplo.</p><blockquote><p style=text-align:justify>A continuación, tenemos la implementación del algoritmo de thresholding. Se pueden cargar imágenes a color, las cuales son transformadas a escala de grises para posteriormente aplicar el algoritmo. Además, muestra el histograma con los valores de los pixeles y la cantidad que hay de cada uno. Se puede ajustar el valor de threshold en un rango de 0 a 250 con saltos de 25.</p><iframe id=thresholding style=width:625px;height:525px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/showcase/sketches/dithering/thresholding.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe></blockquote><blockquote class="book-hint info"><p style=text-align:justify>Debido a que la escogencia del umbral es vital, y este depende en gran medida de la composición de la imagen, lo ideal es que este valor sea definido automáticamente. Por esto existen métodos un poco más elaborados de thresholding basados en características como la forma del histograma, los atributos del objeto, la entropía. Además, de métodos basados en clustering(agrupación), métodos espaciales y métodos locales(ver referencia 3).</blockquote><div style=text-align:justify>Ahora, veamos el algoritmo de dithering aleatorio. En este caso ya no tenemos control directo sobre el valor del umbral, ya que este depende únicamente de cómo se generen los números aleatorios para cada pixel. Al igual que el método anterior, este algoritmo es más conveniente para imágenes donde los objetos se distinguen fácilmente del fondo, pues de lo contrario, el ruido que se genera hace más difícil distinguir los objetos en la imagen. Veamos un primer ejemplo de esto:<br><p align=center><img src=/showcase/img/img_dit_aleat.png alt width=500px><br>Fig.3 - imagen generado con dithering aleatorio</p><br><p>Podemos observar que la imagen se puede distinguir fácilmente y es bastante similar a la original, incluyendo detalles como las zonas oscuras al interior de los objetos. Es importante tener en cuenta que los valores aleatorios se están generando en un rango de 0 a 255 pixeles, pero ¿qué pasa si este rango cambia? tal vez podríamos lograr un balance entre el primer método y el actual. Veamos qué sucede si cambiamos el rango en el que se genera el umbral aleatorio, en una imagen con mayor detalle y rango de pixeles.</p><p align=center><img src=/showcase/img/img_dit_aleat2.png alt width=400px><br>Fig.3 - imagen con valores de umbral aleatorio en distintos rangos</p><br><p>Al limitar el rango de aleatoriedad, se reduce la cantidad de ruido que se genera, por lo que podemos notar una mejora significativa en la imagen. Vemos que detalles como sombras o ciertos objetos que probablemente no se podrían ver con claridad usando thresholding. Aquí, lo interesante es identificar un rango ideal para lograr la mayor cantidad de detalles con la menor cantidad de ruido posible.</p><p>Notemos que para la primera imagen utilizada(figura 1), usando thresholding obtenemos un resultado adecuado, sin embargo, usando dithering aletorio y limitando el rango del umbral podemos obtener una imagen un poco más detallada.</p><p align=center><img src=/showcase/img/img_dit_aleat3.png alt width=500px><br>Fig.3 - otro ejemplo de dithering aleatorio sujeto a un rango de 50 a 200px</p></div><blockquote><p style=text-align:justify>A continuación, tenemos la implementación del algoritmo de dithering aleatorio. Este funciona de la misma manera que el anterior algoritmo, solo que en este caso, el parámetro a modificar es el rango de valores en los cuales varía el umbral generado aleatoriamente. Además, se da la opción al usuario de generar una nueva imagen con valores aleatorios diferentes.</p><iframe id=random_dithering style=width:625px;height:425px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/showcase/sketches/dithering/random_dithering.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe></blockquote></blockquote><h3 id=código>Código
<a class=anchor href=#c%c3%b3digo>#</a></h3><blockquote><details><summary>Código completo la implementación del algoritmo de thresholding</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>; <span style=color:#75715e>//imagen original
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newImg</span>; <span style=color:#75715e>//imagen transformada
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>slider</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pxs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>256</span>); <span style=color:#75715e>//arreglo de cantidad de cada pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>thr</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>; <span style=color:#75715e>//valor del umbral
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maxval</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cur_thr</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/showcase/sketches/dithering/paleta_grises.png&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#e6db74>&#34;#C0DDEB&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>190</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>slider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>25</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>30</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;150px&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;thresholding value&#34;</span>, <span style=color:#ae81ff>170</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>15</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;  0     50  100  150  200   250&#34;</span>, <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>35</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cur_thr</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dst</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//calcula el pixel destino
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>src</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>thr</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//condición thresholding
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>maxval</span>, <span style=color:#a6e22e>maxval</span>, <span style=color:#a6e22e>maxval</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>src</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//obtiene el pixel original
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>px</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>)[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>px</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>updateImg</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>dst</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>newImg</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getPixelInfo</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>/*si el tamaño de la imagen es muy grande,
</span></span></span><span style=display:flex><span><span style=color:#75715e>      se hace un reajuste*/</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgW</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>300</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgH</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgW</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgH</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>300</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>resize</span>(<span style=color:#a6e22e>imgW</span>, <span style=color:#a6e22e>imgH</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>getPixelInfo</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>thr</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>modified</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>thr</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>cur_thr</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>/*actualiza la imagen filtrada sólo cuando se modifica el
</span></span></span><span style=display:flex><span><span style=color:#75715e>      valor del umbral o cuando se sube una nueva imagen,evitando
</span></span></span><span style=display:flex><span><span style=color:#75715e>      así la repetición de cálculos en cada llamada a draw()*/</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>updateImg</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>cur_thr</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#C0DDEB&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//gráfica de pixeles
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#FFF5A2&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;         &#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;  0&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>sp</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  50&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>sp</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; 100&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>sp</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;150&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>sp</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>sp</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;250&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>25</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;red&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>graph</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;black&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>90</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotate</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>HALF_PI</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;cantidad&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>translate</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotate</span>(<span style=color:#a6e22e>HALF_PI</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>text</span>(<span style=color:#e6db74>&#34;valor del pixel&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;image&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>GRAY</span>); <span style=color:#75715e>// convierte la imagen a escala de grises
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;El archivo seleccionado no es una imagen.&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawImage</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>220</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getPixelInfo</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pxs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>256</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>255</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) <span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>)[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>graph</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;red&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;blue&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>m</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>pxs</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>255</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>38</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>38</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>/</span> <span style=color:#a6e22e>m</span>) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>38</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><div style=text-align:justify><p>A continuación se muestra de forma más detallada las partes claves del código anterior.</p><p><details open><summary>algoritmo base de dithering</summary><div class=markdown-inner><p>Como algoritmo base tenemos la función <code>dst</code> que retorna el pixel final resultante del algoritmo de dithering. Dentro de esta, la función <code>src</code> obtiene el pixel de la imagen original para después evaluar si este es mayor o menor al umbral <code>thr</code> definido y dependiendo de esto retorna un pixel blanco <code>color(255, 255, 255)</code> o un pixel negro <code>color(0, 0, 0)</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dst</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>src</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>thr</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>maxval</span>, <span style=color:#a6e22e>maxval</span>, <span style=color:#a6e22e>maxval</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>src</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>px</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>)[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>px</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><details open><summary>actualización de la imagen</summary><div class=markdown-inner><p>Con el fin de evitar cargar y actualizar los pixeles de la imagen en cada llamada de la función <code>draw()</code> se opta por tener la función <code>updateImg()</code> que es llamada únicamente cuando se carga una imagen o cuando se modifica un parámetro. Esta se encarga de obtener los datos de la imagen original, para esto primero se cargan los datos de los pixeles con ayuda de <code>img.loadPixels()</code>, luego creamos un objeto p5.Renderer con <code>newImg = createGraphics(img.width, img.height)</code> en el cual vamos a almacenar los datos procesados por nuestro algoritmo con ayuda de un for que recorre toda la imagen y con <code>newImg.set(i, j, dst(i, j))</code>. Finalmente, usamos <code>newImg.updatePixels()</code> para que aparezcan los cambios y actualizamos la información de los pixeles con <code>getPixelInfo()</code> para generar la gráfica correspondiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>(){
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>modified</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>thr</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>cur_thr</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateImg</span>();
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>updateImg</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>dst</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>newImg</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getPixelInfo</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></br><details open><summary>gráfica de pixeles</summary><div class=markdown-inner><p>Cada vez que se actualiza la imagen, la información del número de pixeles que hay de cada valor se actualiza con la función <code>getPixelInfo()</code>. Allí se crea un arreglo de tamaño 256 con todas sus posiciones inicializadas en 0, luego se recorre toda la imagen y se va sumando uno a la cantidad total de pixeles con determinado valor. Con esta información se genera la gráfica con <code>graph()</code> la cual dependiendo del valor dibuja una línea de un tamaño proporcional a esa cantidad(se usa el valor máximo del arreglo para escalar todos los valores).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getPixelInfo</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pxs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>256</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>255</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) <span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>)[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>graph</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;red&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;blue&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>m</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>pxs</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>255</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>38</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>38</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>/</span> <span style=color:#a6e22e>m</span>) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>38</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></p></div></br><details><summary>Código completo de la implementación del algoritmo de dithering aleatorio</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>; <span style=color:#75715e>//imagen original
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newImg</span>; <span style=color:#75715e>//imagen transformada
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>slider</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pxs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>256</span>); <span style=color:#75715e>//arreglo de cantidad de cada pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmin</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>//rango mínimo del umbral
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmax</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>256</span>; <span style=color:#75715e>//rango máximo del umbral
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/showcase/sketches/dithering/paleta_grises.png&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#e6db74>&#34;#C0DDEB&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createButton</span>(<span style=color:#e6db74>&#34;generar nueva imagen&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>mousePressed</span>(<span style=color:#a6e22e>generateNewImg</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>160</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;0 - 255&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;50 - 200&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#34;100 - 255&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#34;0 - 255&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>changed</span>(<span style=color:#a6e22e>mySelectEvent</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dst</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//calcula el pixel destino
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>src</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>umb</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//condición de dithering
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>src</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//obtiene el pixel original
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>px</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>)[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>px</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>updateImg</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>umb</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span>(<span style=color:#a6e22e>rmin</span>, <span style=color:#a6e22e>rmax</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>dst</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newImg</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>newImg</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getPixelInfo</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>/*si el tamaño de la imagen es muy grande,
</span></span></span><span style=display:flex><span><span style=color:#75715e>      se hace un reajuste*/</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgW</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>300</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgH</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgW</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgH</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>300</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>resize</span>(<span style=color:#a6e22e>imgW</span>, <span style=color:#a6e22e>imgH</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>getPixelInfo</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>modified</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>true</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>/*actualiza la imagen filtrada sólo cuando se sube una
</span></span></span><span style=display:flex><span><span style=color:#75715e>      nueva imagen,evitando así la repetición de cálculos en
</span></span></span><span style=display:flex><span><span style=color:#75715e>      cada llamada a draw()*/</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>updateImg</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#C0DDEB&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rect</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;image&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>GRAY</span>); <span style=color:#75715e>// convierte la imagen a escala de grises
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;El archivo seleccionado no es una imagen.&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawImage</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>220</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getPixelInfo</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pxs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>256</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>255</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) <span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pxs</span>[<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>)[<span style=color:#ae81ff>0</span>]] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>generateNewImg</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>modified</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mySelectEvent</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>item</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sel</span>.<span style=color:#a6e22e>value</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>item</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0 - 255&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmin</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmax</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>256</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>item</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;100 - 255&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmin</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmax</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>item</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;50 - 200&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmin</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmax</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmin</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rmax</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><div style=text-align:justify><p>Para el algoritmo de dithering aleatorio de reutilizó gran parte del código para thresholding. El único cambio significativo es en la variable del umbral <code>umb</code> la cual esta vez es generada de manera aleatoria en un rango entre <code>rmin</code> y <code>rmax</code>, valores que pueden ser modificadas por el usuario.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>umb</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span>(<span style=color:#a6e22e>rmin</span>, <span style=color:#a6e22e>rmax</span>);
</span></span></code></pre></div></div></blockquote><h2 id=conclusión>Conclusión
<a class=anchor href=#conclusi%c3%b3n>#</a></h2><blockquote><div style=text-align:justify>La implementación del dithering es una buena manera de tener un primer acercamiento al concepto de cuantización de color. Este nos permite representar una imagen en escala de grises como una imagen formada únicamente con pixeles de colores blanco y negro. Existen diversos métodos de dithering, entre ellos están el thresholding o dithering promedio y el dithering aleatorio. Con ambos métodos podemos obtener una buena representación de imágenes con poco nivel de detalle y con alto contraste entre los objetos que la componen. Sin embargo, para imágenes donde los colores son más homogéneos y hay una mayor cantidad de detalles, estos algoritmos suelen fallar. Este problema se pueda solucionar parcialmente utilizando dithering aleatorio para un rango de valores limitado, lo cual ayuda a disminuir el ruido generado por la aleatoriedad, dando con resultado una imagen con más detalle del que se puede obtener con el algoritmo de thresholding.</div><h3 id=trabajo-futuro>Trabajo Futuro
<a class=anchor href=#trabajo-futuro>#</a></h3><div style=text-align:justify>Debido a los diferentes inconvenientes que se generan con una u otra implementación de dithering, han surgido otro tipo de variaciones de este algoritmo, los cuales corrigen algunos problemas o tienen una mejora sustancial en el algoritmo para mejorar la representación de las imágenes. Por esta razón, como trabajo futuro se propone implementar otros tipos de dithering, algunos de los más conocidos incluyen: el dithering ordenado, que usa una matriz para modificar cada pixel y el dithering por difusión de error, que se retroalimenta de la información de los pixeles más cercanos a cada pixel particular. Además, se puede explorar el dithering aplicado en un rango mayor de colores, es decir, utilizar más de dos colores en la generación de una imagen.<p align=center><img src=/showcase/img/ditheringmontage.png alt width=400px><br>Fig.3 - diferentes tipos de dithering</p></div></blockquote><h2 id=referencias>Referencias
<a class=anchor href=#referencias>#</a></h2><ol><li>Wikipedia contributors. &ldquo;Dither&rdquo;. Tomado de <a href=https://en.wikipedia.org/wiki/Dither#Applications>https://en.wikipedia.org/wiki/Dither#Applications</a></li><li>Bankhead, Pete. &ldquo;Thresholding&rdquo;. Tomado de <a href=https://bioimagebook.github.io/chapters/2-processing/3-thresholding/thresholding.html>https://bioimagebook.github.io/chapters/2-processing/3-thresholding/thresholding.html</a></li><li>Guruprasad, Prathima. &ldquo;OVERVIEW OF DIFFERENT THRESHOLDING METHODS IN IMAGE PROCESSING&rdquo;. Tomado de <a href=https://www.researchgate.net/publication/342038946_OVERVIEW_OF_DIFFERENT_THRESHOLDING_METHODS_IN_IMAGE_PROCESSING>https://www.researchgate.net/publication/342038946_OVERVIEW_OF_DIFFERENT_THRESHOLDING_METHODS_IN_IMAGE_PROCESSING</a></li><li>Correia, A. Salgado, P. Blanco, W. &ldquo;Random Dithering&rdquo;. Tomado de <a href=https://www.visgraf.impa.br/Courses/ip00/proj/Dithering1/random_dithering.html>https://www.visgraf.impa.br/Courses/ip00/proj/Dithering1/random_dithering.html</a></li><li>&ldquo;Dithering&rdquo;. Tomado de <a href=https://imagej.net/plugins/dithering>https://imagej.net/plugins/dithering</a></li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#cuantificación-del-color-y-dithering>Cuantificación del Color y Dithering</a><ul><li><a href=#introducción>Introducción</a><ul><li><a href=#antecedentes-y-trabajo-previo>Antecedentes y trabajo previo</a></li></ul></li><li><a href=#ejercicio>Ejercicio</a><ul><li><a href=#solución>Solución</a></li><li><a href=#código>Código</a></li></ul></li><li><a href=#conclusión>Conclusión</a><ul><li><a href=#trabajo-futuro>Trabajo Futuro</a></li></ul></li><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></div></aside></main></body></html>